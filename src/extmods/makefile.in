EXTMODS=@EXTMODS@
BRANCH=trunk

default: extmods

extmods: ${EXTMODS}
checkout update:
	for dir in ${EXTMODS}; do \
	  if test -f $${dir}.skip; then \
	    echo > /dev/null; \
	  elif test -d $${dir}/.git; then \
	    command cd $${dir}; \
	    git checkout trunk; \
	    git pull; \
	    command cd ..; \
	  else \
	    echo "Making local .git repo"; \
	    make "$${dir}/.git"; \
	  fi; \
	done

build: extmods
	domake ${EXTMODS}
testbuild: extmods
	submake ${EXTMODS}
fresh: extmods
	domake ${EXTMODS} fresh
clean: extmods
	domake ${EXTMODS} clean
install: extmods
	domake ${EXTMODS} install
alpine: extmods
	domake ${EXTMODS} alpine
debfresh: extmods
	domake ${EXTMODS} fresh
	domake ${EXTMODS} debfresh

debclean:
	rm -f *.deb *.ddeb *.changes *.buildinfo


.PHONY: extmods build fresh clean install alpine debfresh testbuild

hyphenate hyphenate/.git:
	git clone git@github.com:beingmeta/kno-hyphenate.git hyphenate
imagetools imagetools/.git:
	git clone git@github.com:beingmeta/kno-imagetools.git imagetools
leveldb leveldb/.git:
	git clone git@github.com:beingmeta/kno-leveldb.git leveldb
mod_knocgi mod_knocgi/.git:
	git clone git@github.com:beingmeta/mod_knocgi.git mod_knocgi
mongodb mongodb/.git:
	git clone git@github.com:beingmeta/kno-mongodb.git mongodb
mysql mysql/.git:
	git clone git@github.com:beingmeta/kno-mysql.git mysql
nng nng/.git:
	git clone git@github.com:beingmeta/kno-nng.git nng
odbc odbc/.git:
	git clone git@github.com:beingmeta/kno-odbc.git odbc
rocksdb rocksdb/.git:
	git clone git@github.com:beingmeta/kno-rocksdb.git rocksdb
sundown sundown/.git:
	git clone git@github.com:beingmeta/kno-sundown.git sundown
tidy tidy/.git:
	git clone git@github.com:beingmeta/kno-tidy.git tidy
zeromq zeromq/.git:
	git clone git@github.com:beingmeta/kno-zeromq.git zeromq
ziptools ziptools/.git:
	git clone git@github.com:beingmeta/kno-ziptools.git ziptools

